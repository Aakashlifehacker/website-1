<!-- Start of openaccessbutton Zendesk Widget script -->
<script>/*<![CDATA[*/window.zEmbed||function(e,t){var n,o,d,i,s,a=[],r=document.createElement("iframe");window.zEmbed=function(){a.push(arguments)},window.zE=window.zE||window.zEmbed,r.src="javascript:false",r.title="",r.role="presentation",(r.frameElement||r).style.cssText="display: none",d=document.getElementsByTagName("script"),d=d[d.length-1],d.parentNode.insertBefore(r,d),i=r.contentWindow,s=i.document;try{o=s}catch(e){n=document.domain,r.src='javascript:var d=document.open();d.domain="'+n+'";void(0);',o=s}o.open()._l=function(){var o=this.createElement("script");n&&(this.domain=n),o.id="js-iframe-async",o.src=e,this.t=+new Date,this.zendeskHost=t,this.zEQueue=a,this.body.appendChild(o)},o.write('<body onload="document._l();">'),o.close()}("https://assets.zendesk.com/embeddable_framework/main.js","openaccessbutton.zendesk.com");
/*]]>*/</script>
<!-- End of openaccessbutton Zendesk Widget script -->

<div class="strap strap-compact" style="background-image:url(/static/book.jpg);background-color:transparent;min-height:500px;background-size:100% 100%;background-repeat:no-repeat;padding-top:10%;margin-top:-80px;" id="topstrap">
  <div class="container-fluid">
    <div class="row">
      <div class="col-md-8 col-md-offset-2 intro">
        <div class="row">
          <div class="col-md-3 col-md-offset-2 hidden-xs hidden-sm">
            <img src="/static/icon_OAB_blue.png">
          </div>
          <div class="col-md-7">
            <h1 style=";font-size:3em;margin-top:5px;">Paywalls<br>Avoided,<br> Data<br>shared.</h1>
          </div>
        </div>
        <div class="row" style="margin-top:-20px;margin-bottom:50px;">
          <div class="col-md-9 col-md-offset-2">
            <h3 style="font-size:1.3em;">Comprehensive, instant, legal search and requests for inaccessible research in just a click.</h3>
          </div>
        </div>
        <div class="input-group">
          <textarea id="url" class="form-control" style="min-height:34px;height:34px;" placeholder="Enter an article URL, DOI, Pubmed ID, PMC ID, Title, or Citation"></textarea>
          <div class="input-group-btn">
            <a class="btn btn-action btn-block" href="#" id="find" style="padding:7px 10px 5px 10px;"><i class="glyphicon glyphicon-search"></i></a>
          </div>
        </div>
        <p style="font-size:0.8em;font-weight:bold;">
          <br>
          <a href="#" id="showexamples" style="text-decoration:underline;">Examples</a>
          <a href="#" id="showhowitworks" style="text-decoration:underline;">How it works</a>
        </p>

        <!-- adding in download button, badly -->

              <div class="row dl ch" id="install" style="margin-top:70px;margin-bottom:100px;">
                <div class="col-md-10">
                  <div class="col-md-1 col-md-offset-1">
                  <p style="font-size:40px;line-height:10px;color:#398bc5;text-align:center;">
                    <i class="glyphicon glyphicon-download"></i>
                  </p>
                  </div>
                </div>
                <div class="col-md-10">
                  <p style="text-align:center;">
                    Always have the button by your side.
                    <a style="margin-top:5px;" class="chromeinstall" target="_blank" href="https://chrome.google.com/webstore/detail/open-access-button/gknkbkaapnhpmkcgkmdekdffgcddoiel">
                    <br>Get the browser extension in one click.
                    </a>
                  </p>
                </div>
              </div>

        <!-- end of terrible addition of download button -->

      </div>

      <div class="col-md-8 col-md-offset-2" id="availability" style="display:none;text-align:center;min-height:800px;">
      </div>

      <div class="col-md-4 col-md-offset-4" id="loading" style="display:none;min-height:800px;">
        <img id="loading" style="height:100%;width:100%;" src="/static/spin_orange.svg">
      </div>
    </div>
  </div>
</div>

<div class="strap strap-white intro" id="examples" style="border-top:2px solid #212f3f;display:none;">
  <div class="container-fluid">
    <div class="row">
      <div class="col-md-8 col-md-offset-2" style="font-size:1.2em;">
        <p>
          DOI: <a class="example" href="#">10.1186/1758-2946-3-47</a><br>
          URL: <a class="example" href="#">http://jcheminf.springeropen.com/articles/10.1186/1758-2946-3-47</a><br>
          Pubmed ID: <a class="example" href="#">21999661</a><br>
          PMC (Pubmed Central) ID: <a class="example" href="#">PMC3206455</a><br>
          Title: <a class="example" href="#">Open Bibliography for Science, Technology, and Medicine</a><br><br>
          Citation: <a class="example" href="#">Jones, R., Macgillivray, M., Murray-Rust, P., Pitman, J., Sefton, P., O'steen, B., & Waites, W. (2011). Open Bibliography for Science, Technology, and Medicine. Journal of Cheminformatics, 3(1), 47. http://doi.org/10.1186/1758-2946-3-47</a><br><br>
          Or try your own favourite citation format (Harvard, Bibtex, etc)<br><br>
        </p>
      </div>
    </div>
  </div>
</div>
<div class="strap strap-white intro" id="howitworks" style="border-top:2px solid #212f3f;display:none;">
  <div class="container-fluid">
    <div class="row">
      <div class="col-md-8 col-md-offset-2" style="font-size:1.2em;">
        <p>
    Finding Available Research
    Give us an scholarly paper and we’ll search thousands of sources with millions of articles to try and link you to free, legal, full text articles instantly.
    Requesting Research
    If we are unable to get you access instantly, we’ll start a request for you. Requests are sent to the author, and when we hear back the content is sent to you and made available to everyone!
        </p>
      </div>
    </div>
  </div>
</div>

<script>
  jQuery(document).ready(function() {
    $('#topnav').css('background-color','transparent');
    $('#footer').css('margin-top','-65px');

    $('#showexamples').bind('click',function(e) { e.preventDefault(); $('#topstrap').css('height',''); $('#examples').toggle(); });
    if ($(window).width() >= 1000) {
      var height = $(window).height() + 30;
      $('#topstrap').css('height',height+'px');
    }

    var example = function(e) {
      if (e) e.preventDefault();
      $('#url').val($(this).html()).trigger('keyup');
      setTimeout(function() { $('#find').trigger('click'); }, 700);
    }
    $('.example').bind('click',example);

    var api = 'https://api.openaccessbutton.org';
    if (window.location.host.indexOf('openaccessbutton.org') === -1 || window.location.host.indexOf('dev.openaccessbutton.org') !== -1) {
      api = 'https://dev.api.cottagelabs.com/service/oab';
      clogin.api = 'https://dev.api.cottagelabs.com/accounts';
    }
    clogin.login();

    var availability = function(e) {
      if ($(this).attr('id') === 'find' || e === undefined || e.keyCode === 13) {
        if (e && $(this).attr('id') === 'find') e.preventDefault();
        var url = $('#url').val().trim();
        if (!url.length) {
          $('#url').css('border-color','#f04717').focus();
          return;
        }
        if (url.lastIndexOf('.') === url.length-1) url = url.substring(0,url.length-1);
        $('.intro').hide();
        $('#loading').show();
        var opts = {
          type:'GET',
          url:api+'/availability?url='+encodeURIComponent(url),
          success: function(data) {
            $('#loading').hide();
            $('#availability').show();
            var has = {};
            if (data.data.availability.length > 0) {
              for ( var a in data.data.availability ) {
                has[data.data.availability[a].type] = {url:data.data.availability[a].url};
              }
            }
            if (data.data.requests.length > 0) {
              for ( var r in data.data.requests ) {
                if (!has[data.data.requests[r].type]) has[data.data.requests[r].type] = {id:data.data.requests[r]._id,ucreated:data.data.requests[r].ucreated,usupport:data.data.requests[r].usupport};
              }
            }
            if (data.data.match && data.data.match.indexOf('http') !== 0 && data.data.meta && data.data.meta.article && data.data.meta.article.doi) data.data.match = 'https://doi.org/' + data.data.meta.article.doi;
            if (JSON.stringify(has) === '{}') {
              window.location = '/request?url=' + encodeURIComponent(data.data.match);
            } else if (has.article && !has.data) {
              var availability = '';
              if (has.article.id) {
                availability += '<p style="color:#212f3f;text-align:center;padding-top:50px;">';
                if (has.article.ucreated) {
                  availability += 'You already created a request for this article <a class="btn btn-action" href="/request/' + has.article.id + '">View the request</a></p>';
                } else if (has.article.usupport) {
                  availability += 'You already support a request for this article <a class="btn btn-action" href="/request/' + has.article.id + '">View the request</a></p>';
                } else {
                  availability += 'There is an open request for this article <a class="btn btn-action" href="/request/' + has.article.id + '?support=true">Add your support</a></p>';
                }
              } else {
                availability += '<h2 style="color:#212f3f;text-align:center;">This article is available!</h2>';
                availability += '<h3 style="text-align:center;"><a style="word-wrap:break-word;overflow-wrap:break-word;" target="_blank" href="' + has.article.url + '">' + has.article.url + '</a></h3>';
              }
              availability += '<p style="color:#212f3f;text-align:center;padding-top:50px;">';
              availability += 'Do you need access to the data instead? ';
              availability += '<a class="btn btn-action" href="/request?type=data&url=' + encodeURIComponent(data.data.match) + '">Start a data request</a></p>';
              $('#availability').html(availability);
            } else if (!has.article && has.data) {
              var availability = '<h2 style="color:#212f3f;text-align:center;">This article is not available</h2>';
              availability += '<h3 style="text-align:center;"><a class="btn btn-action" href="/request?url=' + encodeURIComponent(data.data.match) + '">Start a request</a></h3>';
              availability += '<p style="color:#212f3f;text-align:center;padding-top:50px;">';
              if (has.data.id) {
                if (has.data.ucreated) {
                  availability += 'You already created a request for data for this article <a class="btn btn-action" href="/request/' + has.data.id + '">View the request';
                } else if (has.data.usupport) {
                  availability += 'You already support a request for data for this article <a class="btn btn-action" href="/request/' + has.data.id + '">View the request';
                } else {
                  availability += 'There is an open request for data for this article <a class="btn btn-action" href="/request/' + has.data.id + '?support=true">Add your support';
                }
              } else {
                availability += 'However there is data available:</p>';
                availability += '<p style="text-align:center;"><a style="word-wrap:break-word;overflow-wrap:break-word;" target="_blank" href="' + has.data.url + '">' + has.data.url;
              }
              availability += '</a></p>';
              $('#availability').html(availability);
            } else if (has.article && has.data) {
              if (has.article.id && has.data.id) {
                window.location = '/request/' + has.article.id;
              } else {
                var availability = '<h2 style="color:#212f3f;text-align:center;">';
                if (has.article.url) {
                  availability += 'This article is available!</h2>';
                  availability += '<h3 style="text-align:center;"><a style="word-wrap:break-word;overflow-wrap:break-word;" target="_blank" href="' + has.article.url + '">' + has.article.url;
                }
                if (has.article.id) {
                  if (has.article.ucreated) {
                    availability += 'You already created a request for this article <a class="btn btn-action" href="/request/' + has.article.id + '">View the request';
                  } else if (has.article.usupport) {
                    availability += 'You already support a request for this article <a class="btn btn-action" href="/request/' + has.article.id + '">View the request';
                  } else {
                    availability += 'There is an open request for this article <a class="btn btn-action" href="/request/' + has.article.id + '?support=true">Add your support';
                  }
                }
                availability += '</a></h3><p style="color:#212f3f;text-align:center;padding-top:50px;">';
                if (has.data.url) {
                  availability += 'And there is data available for this article:</p><p style="text-align:center;">';
                  availability += '<a style="word-wrap:break-word;overflow-wrap:break-word;" target="_blank" href="' + has.data.url + '">' + has.data.url;
                }
                if (has.data.id) {
                  if (has.data.ucreated) {
                    availability += 'You already created a request for data for this article <a class="btn btn-action" href="/request/' + has.data.id + '">View the request';
                  } else if (has.data.usupport) {
                    availability += 'You already support a request for data for this article <a class="btn btn-action" href="/request/' + has.data.id + '">View the request';
                  } else {
                    availability += 'There is an open request for data for this article <a class="btn btn-action" href="/request/' + has.data.id + '?support=true">Add your support';
                  }
                }
                availability += '</a></p>';
                $('#availability').html(availability);
              }
            }
          },
          error: function() {
            $('#loading').hide();
            $('#loading').after('<p>Sorry, something went wrong.</p>');
          }
        };
        if (clogin.apikey) {
          opts.beforeSend = function (request) { request.setRequestHeader("x-apikey", clogin.apikey); };
          opts.type = 'POST';
          opts.url = api+'/availability';
          opts.cache = false;
          opts.processData = false;
          opts.contentType = 'application/json';
          opts.dataType = 'json';
          opts.data = JSON.stringify({url:url});
        }
        $.ajax(opts);
      } else {
        if ( $('#url').val().length > 70 ) {
          var ht = 30 * (Math.floor($('#url').val().length / 70)+1);
          $('#url').css('min-height',ht+'px');
          $('#find').css('min-height',ht+'px');
        }
      }
    }
    $('#url').bind('keyup',availability);
    $('#find').bind('click',availability);

    var id;
    if (window.location.href.indexOf('url=') !== -1) id = decodeURIComponent(window.location.href.split('url=')[1].split('&')[0]);
    if (window.location.href.indexOf('doi=') !== -1) id = decodeURIComponent(window.location.href.split('doi=')[1].split('&')[0]);
    if (window.location.href.indexOf('pmid=') !== -1) id = decodeURIComponent(window.location.href.split('pmid=')[1].split('&')[0]);
    if (window.location.href.indexOf('pmc=') !== -1) id = decodeURIComponent(window.location.href.split('pmc=')[1].split('&')[0]);
    if (window.location.href.indexOf('pmcid=') !== -1) id = decodeURIComponent(window.location.href.split('pmcid=')[1].split('&')[0]);
    if (window.location.href.indexOf('title=') !== -1) id = decodeURIComponent(window.location.href.split('title=')[1].split('&')[0]);
    if (window.location.href.indexOf('citation=') !== -1) id = decodeURIComponent(window.location.href.split('citation=')[1].split('&')[0]);
    if (window.location.href.indexOf('identifier=') !== -1) id = decodeURIComponent(window.location.href.split('identifier=')[1].split('&')[0]);
    if (window.location.href.indexOf('ident=') !== -1) id = decodeURIComponent(window.location.href.split('ident=')[1].split('&')[0]);
    if (window.location.href.indexOf('id=') !== -1) id = decodeURIComponent(window.location.href.split('id=')[1].split('&')[0]);
    if (id) {
      $('#url').val(id).trigger('keyup');
      availability();
    }

  });
</script>
