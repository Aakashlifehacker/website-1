<style>
  #docs h2 {
    margin-top:80px;
  }
  @media handheld, only screen and (max-width: 767px) {
    #docs {
      word-wrap: break-word;
    }
    code {
      white-space: pre-wrap;
    }
  }
</style>

<div class="container-fluid">
  <div class="row">
    <div class="col-md-8 col-md-offset-2">
      <h1 style="text-align:left;margin-top:25px;margin-bottom:25px;font-size:4em;">
        API
      </h1>
      <p>
        Free REST JSON API for everything the Open Access Button does including <a href="#find">Finding Open Access content</a>, making & searching requests to open up content, depositing content, finding meta-data, <a href="#subscriptions">subscriptions</a>, and making & searching Interlibrary loans. Support available at joe@openaccessbutton.org.
      </p>
    </div>
  </div>
</div>

<div class="container-fluid" id="docs" style="margin-bottom:100px;">
  <div class="row">
    <div class="col-md-8 col-md-offset-2" style="text-align:justify;">
      <p id="apikey">
        <a href="/account?next=/api" class="label label-info">Logging in</a> isn’t required, but it gets you an API key, helps us tell funders how we’re doing, and lets us contact you with issues and updates.
      </p>
      <p>
        Please limit your requests to one per second. We don’t enforce rate limits but if we notice prolonged high usage we may suspend your account and contact you about your needs.
      <p>
      If you’re looking to integrate us with your tools, but aren’t able to code, our <a href="https://openaccessbutton.org/libraries">tools for librarians</a>, especially <a href="https://openaccessbutton.org/integrations">integration guides</a>, may be a better fit.
    </p>

      <h2>
        {{api}}
      </h2>
      <p>
        This is the base URL of our API
      </p>
      <hr>
      <h3>
        GET
      </h3>
      <p>
        Examples: <a href="{{api}}" class="api">URL</a> |
          <a class="api example" target="_blank" href="#get_root">
            cURL
          </a>
      </p>
      <pre id="get_root" class="example">
curl -X GET "{{api}}"</pre>
      <p>
        Returns a JSON status success message and 200 response code if the API is operational.
      </p>

      <h2 id="find">
        /find
      </h2>
      <p>
        Gives URL to any Open Access paper.
      </p>
      <hr>
      <h3>
        GET
      </h3>
        <p>
          <!-- TODO: HAVE 'HAVECODEREPLACETHIS' be replaced with code when logged in -->
            Example: <a href="{{api}}/availability?id=http%3A%2F%2Fscience.sciencemag.org%2Fcontent%2F196%2F4287%2F293%2Ftab-pdf&apikey=HAVECODEREPLACETHIS" class="api">URL</a> | <a href="{{api}}/availability?id=10.1126%2Fscience.196.4287.293&apikey=HAVECODEREPLACETHIS" class="api">DOI</a> | <a href="{{api}}/availability?id=Ribulose%20bisphosphate%20carboxylase%3A%20a%20two-layered%2C%20square-shaped%20molecule%20of%20symmetry%20422&apikey=HAVECODEREPLACETHIS" class="api">Title</a> | <a class="api example" href="#get_find" target="_blank">cURL</a>
<pre id="get_find" class="example">
curl -H "x-apikey: APIKEY-HAVECODEREPLACETHIS" -X GET "https://api.openaccessbutton.org/find?id=10.1234/567890"</pre>
        </p>
      <p>
        Accepts a single parameter called “id”, which should contain (in order of preference) a URL-encoded doi, pmc, pmid, url, title, or citation.
      </p>


      <h2 id="subscriptions">
        /subscription
      </h2>
      <p>
        Tells you if an institution has access to a certain paper and provides a direct link
      </p>
      <hr>
      <h3>
        GET
      </h3>
        <p>
          <a class="api" target="_blank" href="{{api}}/subscription?uid=WpGYaq7yRCNggawBY&doi=10.1145/2908080.2908114/availability?url=http%3A%2F%2Fjournals.plos.org%2Fplosone%2Farticle%3Fid%3Dinfo%253Adoi%2F10.1371%2Fjournal.pone.0163591">
            Example
          </a>
        </p>

        <p>
          Requires both an paper ID, and a specified institution to return a response. Accepts papers IDs as described in /find. Institutions are specified by passing a code in “UID”.
          <p>

      <p id="InstantILL">
        <!-- TODO:  -->
        Institutions are specified by passing a code, obtained by logging in and setting up InstantILL with your subscription. | Your institution is code is <<your ID>> by passing a code in “uid”. You’ll need to set this up with InstantILL.
      </p>

    </div>
  </div>
</div>



<script>
  jQuery(document).ready(function() {
    $('pre.example').hide();
    $('a.example').bind('click',function(e) { e.preventDefault(); $($(this).attr('href')).toggle(); });
    noddy.afterLogin = function() {
      if (noddy.apikey) {
        $('#apikey').html('Your API key is <code>' + noddy.apikey + '</code>' +'Include this in either a URL param called "apikey" or a header called "x-apikey".');
        $('.auth').each(function() { $(this).attr('href',$(this).attr('href')+'?apikey='+noddy.apikey); });
        $('.apikey').html(noddy.apikey);
        $('.yourid').html(noddy.user.account._id);
      } else {
        $('.auth').hide();
      }
    }
    noddy.login();
  });
</script>
